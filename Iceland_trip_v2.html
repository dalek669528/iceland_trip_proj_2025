<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>冰島之旅完整儀表板</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
        }

        .tab-btn.active {
            @apply bg-blue-600 text-white shadow-lg;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .sidebar-nav-btn.active {
            @apply bg-blue-200;
        }
    </style>
</head>

<body class="bg-gray-100">

    <div class="dashboard-container">
        <!-- Header Section -->
        <header class="text-center py-8">
            <h1 class="text-5xl font-extrabold text-blue-900 mb-2">冰島12日自駕之旅</h1>
            <p class="text-lg text-gray-600">完整行程儀表板，輕鬆掌握您的旅程。</p>
            <div class="mt-4 flex flex-wrap justify-center items-center text-sm text-gray-500 space-x-4">
                <span>出發：10/10</span>
                <span>回程：10/22</span>
                <span class="text-blue-500 font-semibold">12日行程</span>
            </div>
        </header>

        <!-- Main Dashboard Content -->
        <main class="bg-white p-6 rounded-3xl shadow-2xl border border-gray-200">
            <!-- Tabs Navigation -->
            <nav class="flex justify-center mb-6 border-b border-gray-200">
                <button data-tab="itinerary" class="tab-btn active px-6 py-3 text-lg font-semibold rounded-t-xl transition-all duration-300">行程</button>
                <button data-tab="accommodation" class="tab-btn px-6 py-3 text-lg font-semibold rounded-t-xl transition-all duration-300">住宿</button>
                <button data-tab="memo" class="tab-btn px-6 py-3 text-lg font-semibold rounded-t-xl transition-all duration-300">待辦事項與備註</button>
            </nav>

            <!-- Itinerary Tab Content -->
            <div id="itinerary-tab" class="tab-content active grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Day Navigation Sidebar -->
                <aside class="bg-gray-50 p-6 rounded-2xl border border-gray-200 lg:col-span-1">
                    <h2 class="text-xl font-bold mb-4 text-blue-900">每日行程</h2>
                    <nav>
                        <ul id="day-nav-list" class="space-y-2">
                            <!-- Day navigation items generated by JS -->
                        </ul>
                    </nav>
                </aside>

                <!-- Itinerary Details and Chart -->
                <section class="lg:col-span-2">
                    <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-200">
                        <div class="mb-6 border-b pb-4">
                            <h2 id="current-day-title" class="text-3xl font-extrabold text-blue-800 mb-1"></h2>
                            <p id="current-day-theme" class="text-lg text-gray-600"></p>
                        </div>
                        
                        <!-- Itinerary Table -->
                        <div class="overflow-x-auto mb-6">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 uppercase rounded-tl-lg">
                                            時間
                                        </th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 uppercase">
                                            行程
                                        </th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 uppercase">
                                            車程
                                        </th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 uppercase">
                                            停留時間
                                        </th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 uppercase rounded-tr-lg">
                                            備註與建議
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="itinerary-table-body" class="bg-white divide-y divide-gray-200">
                                    <!-- Itinerary details rendered by JS -->
                                </tbody>
                            </table>
                        </div>

                        <!-- Time Allocation Chart -->
                        <div>
                            <h3 class="text-xl font-bold text-blue-900 mb-4">當日時間分配</h3>
                            <div class="flex justify-center items-center">
                                <canvas id="timeChart" class="max-w-md h-auto"></canvas>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Accommodation Tab Content -->
            <div id="accommodation-tab" class="tab-content grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Accommodation cards rendered by JS -->
            </div>

            <!-- To-Do/Memo Tab Content -->
            <div id="memo-tab" class="tab-content grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-200">
                    <h2 class="text-xl font-bold mb-4 text-blue-900">待辦事項</h2>
                    <ul id="todo-list" class="space-y-4 text-gray-700">
                        <!-- To-do items rendered by JS -->
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-200">
                    <h2 class="text-xl font-bold mb-4 text-blue-900">備註與參考資料</h2>
                    <ul id="memo-list" class="space-y-4 text-gray-700">
                        <!-- Memo items and links rendered by JS -->
                    </ul>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Itinerary data
        const itineraryData = [{
            day: '第一天',
            date: '10月11日 (星期五)',
            theme: '抵達與藍湖溫泉',
            schedule: [{
                time: '08:00',
                activity: '抵達凱夫拉維克國際機場 (KEF)',
                drive: 0,
                stay: 0,
                note: '抵達冰島，準備開啟旅程。'
            }, {
                time: '09:00-10:00',
                activity: 'Blue Car Rental 取車',
                drive: 60,
                stay: 0,
                note: '提領行李後，前往租車公司取車。'
            }, {
                time: '10:30-13:30',
                activity: '藍湖溫泉 (Blue Lagoon)',
                drive: 30,
                stay: 180,
                note: '享受冰島獨特的溫泉體驗，緩解長途飛行的疲憊。'
            }, {
                time: '14:00',
                activity: '抵達雷克雅維克住宿',
                drive: 40,
                stay: 0,
                note: '入住您在市中心的 Airbnb。'
            }, {
                time: '15:00',
                activity: '雷克雅維克市區自由行',
                drive: 0,
                stay: 0,
                note: '晚餐後自由逛逛，熟悉環境。'
            }]
        }, {
            day: '第二天',
            date: '10月12日 (星期六)',
            theme: '雷克雅維克城市探索',
            schedule: [{
                time: '上午',
                activity: '雷克雅維克市區探索',
                drive: 0,
                stay: 240,
                note: '參觀哈爾格林姆教堂、太陽航海者雕塑、哈帕音樂廳。'
            }, {
                time: '下午',
                activity: '購物與用餐',
                drive: 0,
                stay: 240,
                note: '在 Laugavegur 購物街逛逛，並享用午餐與晚餐。'
            }]
        }, {
            day: '第三天',
            date: '10月13日 (星期日)',
            theme: '黃金圈與南岸西段',
            schedule: [{
                time: '08:00',
                activity: '雷克雅維克出發',
                drive: 0,
                stay: 0,
                note: '務必準時出發，爭取日照時間。'
            }, {
                time: '08:45-10:00',
                activity: '辛格維利爾國家公園',
                drive: 45,
                stay: 90,
                note: '欣賞板塊裂縫，在步道上漫步。'
            }, {
                time: '10:45-11:45',
                activity: '蓋錫爾間歇泉',
                drive: 45,
                stay: 60,
                note: '等待間歇泉噴發的奇景。'
            }, {
                time: '11:55-13:55',
                activity: '古佛斯瀑布',
                drive: 10,
                stay: 120,
                note: '建議在此用午餐，餐廳提供熱食。'
            }, {
                time: '13:55-15:25',
                activity: '前往塞里雅蘭瀑布',
                drive: 90,
                stay: 0,
                note: '在車上小憩，為下午行程養精蓄銳。'
            }, {
                time: '15:25-16:25',
                activity: '塞里雅蘭瀑布',
                drive: 0,
                stay: 60,
                note: '可繞行至瀑布後方（需注意地面濕滑）。'
            }, {
                time: '16:35-17:35',
                activity: '斯科加爾瀑布',
                drive: 10,
                stay: 60,
                note: '爬上階梯從高處俯瞰瀑布。'
            }, {
                time: '17:45-18:00',
                activity: '黑沙灘 (Reynisfjara)',
                drive: 10,
                stay: 15,
                note: '欣賞日落後再辦理入住。'
            }, {
                time: '18:00',
                activity: '抵達維克',
                drive: 10,
                stay: 0,
                note: '入住The Barn。'
            }]
        }, {
            day: '第四天',
            date: '10月14日 (星期一)',
            theme: '冰川健行與冰河湖',
            schedule: [{
                time: '08:45',
                activity: '維克出發',
                drive: 0,
                stay: 0,
                note: '務必提早出發，為中途的峽谷行程預留充足時間。'
            }, {
                time: '09:45-11:15',
                activity: 'Fjaðrárgljúfur (羽毛峽谷)',
                drive: 60,
                stay: 90,
                note: '步行即可輕鬆抵達觀景點。'
            }, {
                time: '12:00',
                activity: '抵達斯卡夫塔費爾',
                drive: 45,
                stay: 0,
                note: '直接前往 Glacier Guides 報到處。'
            }, {
                time: '12:00-12:40',
                activity: '報到、領取裝備、簡報',
                drive: 0,
                stay: 40,
                note: '必須在 12:40 前抵達！'
            }, {
                time: '13:00-17:00',
                activity: '「Glacier Wonders」冰川健行',
                drive: 0,
                stay: 240,
                note: '盡情享受冰川上的奇景。'
            }, {
                time: '17:45',
                activity: '抵達傑古沙龍冰河湖',
                drive: 45,
                stay: 45,
                note: '欣賞冰河湖的壯觀景色。'
            }, {
                time: '17:50',
                activity: '步行前往鑽石沙灘',
                drive: 5,
                stay: 30,
                note: '在黑沙灘上尋找閃閃發光的浮冰。'
            }, {
                time: '18:30',
                activity: '抵達Hali 鄉村旅館',
                drive: 15,
                stay: 0,
                note: '可就近欣賞冰河湖夜景與極光。'
            }]
        }, {
            day: '第五天',
            date: '10月15日 (星期二)',
            theme: '冰河船與東南岸',
            schedule: [{
                time: '09:00-16:00',
                activity: '「Glacier Magic」冰川健行與冰河船',
                drive: 15,
                stay: 420,
                note: '可於活動期間或結束後，在附近享用輕食或午餐。'
            }, {
                time: '16:00',
                activity: '抵達霍夫 (Höfn)',
                drive: 30,
                stay: 0,
                note: '入住The Greyhouse，並在小鎮自由活動。'
            }]
        }, {
            day: '第六天',
            date: '10月16日 (星期三)',
            theme: '長途駕駛：從霍夫前往胡薩維克',
            schedule: [{
                time: '08:00',
                activity: '霍夫出發',
                drive: 0,
                stay: 0,
                note: '本日車程約 5 小時，務必提早出發，並準備好零食與飲水。'
            }, {
                time: '09:30-10:30',
                activity: 'Vestrahorn (角山)',
                drive: 90,
                stay: 60,
                note: '探索這個充滿戲劇性景觀的冰島地標，非常適合攝影。'
            }, {
                time: '10:30-15:30',
                activity: '前往黛提瀑布 (Dettifoss)',
                drive: 300,
                stay: 0,
                note: '在車上休息，欣賞東部峽灣的風景。'
            }, {
                time: '15:30-17:00',
                activity: '黛提瀑布 (Dettifoss)',
                drive: 0,
                stay: 90,
                note: '歐洲水量最大的瀑布，體驗其震撼的氣勢。'
            }, {
                time: '17:30',
                activity: '抵達胡薩維克',
                drive: 30,
                stay: 0,
                note: '入住您在胡薩維克的 Airbnb，並在小鎮自由活動。'
            }]
        }, {
            day: '第七天',
            date: '10月17日 (星期四)',
            theme: '北部探索：米湖與眾神瀑布',
            schedule: [{
                time: '09:00',
                activity: '胡薩維克住宿出發',
                drive: 0,
                stay: 0,
                note: '本日行程以深度探索米湖周邊為主，可悠閒地啟程。'
            }, {
                time: '09:30-10:30',
                activity: 'Víti 火山湖',
                drive: 30,
                stay: 60,
                note: '前往火山口邊緣，欣賞其獨特的綠松石色湖水。'
            }, {
                time: '10:45-12:00',
                activity: '米湖地熱區 (Hverir) & 黑色城堡 (Dimmuborgir)',
                drive: 15,
                stay: 90,
                note: '探索冒著蒸氣的地熱區和奇形怪狀的熔岩地貌。'
            }, {
                time: '12:00-13:00',
                activity: '在雷恰利茲 (Reykjahlíð) 用午餐',
                drive: 0,
                stay: 60,
                note: '在米湖湖邊的小鎮享用午餐。'
            }, {
                time: '13:15-14:45',
                activity: '米湖溫泉 (Mývatn Nature Baths)',
                drive: 15,
                stay: 90,
                note: '選擇性行程。 若時間充裕，可在此放鬆泡湯。'
            }, {
                time: '15:15-16:15',
                activity: '眾神瀑布 (Goðafoss)',
                drive: 30,
                stay: 60,
                note: '冰島最美的瀑布之一，形狀優美，可從不同角度觀賞。'
            }, {
                time: '16:45',
                activity: '抵達阿克雷里',
                drive: 30,
                stay: 0,
                note: '入住 E18 Apartments。'
            }]
        }, {
            day: '第八天',
            date: '10月18日 (星期五)',
            theme: '西部冒險：前往斯奈山半島',
            schedule: [{
                time: '09:00',
                activity: '阿克雷里出發',
                drive: 0,
                stay: 0,
                note: '本日車程較長，沿途風光無限。'
            }, {
                time: '10:30-11:30',
                activity: 'Hvítserkur (犀牛岩)',
                drive: 90,
                stay: 60,
                note: '觀賞這塊形狀獨特的岩石，有時能看到海豹。'
            }, {
                time: '12:30-13:30',
                activity: '在布扎達呂爾用午餐',
                drive: 60,
                stay: 60,
                note: '抵達住宿地點，先放鬆並享用午餐。'
            }, {
                time: '14:00',
                activity: '抵達布扎達呂爾住宿',
                drive: 60,
                stay: 0,
                note: '入住 城堡民宿 (Castle Guesthouse)。'
            }, {
                time: '15:00-17:00',
                activity: '斯奈山半島東部探索',
                drive: 120,
                stay: 0,
                note: '可在周邊探索，例如前往教會山 (Kirkjufell)。'
            }, {
                time: '18:00',
                activity: '在住宿地點用晚餐',
                drive: 0,
                stay: 0,
                note: '欣賞周邊景色，享受寧靜的夜晚。'
            }]
        }, {
            day: '第九天',
            date: '10月19日 (星期六)',
            theme: '斯奈山半島環狀探索',
            schedule: [{
                time: '09:00',
                activity: '布扎達呂爾出發',
                drive: 0,
                stay: 0,
                note: '今天將完整環繞斯奈山半島。'
            }, {
                time: '10:00-11:30',
                activity: '教堂山 (Kirkjufell)',
                drive: 60,
                stay: 90,
                note: '冰島最上鏡的山峰，可從不同角度拍攝。'
            }, {
                time: '12:00-13:00',
                activity: '阿爾納斯塔皮 (Arnarstapi)',
                drive: 30,
                stay: 60,
                note: '探索玄武岩峭壁與拱門，並在漁村用午餐。'
            }, {
                time: '14:00-15:00',
                activity: '斯奈山冰川國家公園 (Snæfellsjökull National Park)',
                drive: 60,
                stay: 60,
                note: '感受這座壯觀冰川的宏偉氣勢。'
            }, {
                time: '15:30-16:30',
                activity: 'Djúpalónssandur (黑沙灘)',
                drive: 30,
                stay: 60,
                note: '探索獨特的黑沙灘，並嘗試挑戰力士之石。'
            }, {
                time: '17:00',
                activity: '抵達阿爾納斯塔皮住宿',
                drive: 30,
                stay: 0,
                note: '入住 Grund。'
            }]
        }, {
            day: '第十天',
            date: '10月20日 (星期日)',
            theme: '返回雷克雅維克',
            schedule: [{
                time: '09:00',
                activity: '阿爾納斯塔皮出發',
                drive: 0,
                stay: 0,
                note: '開始返回雷克雅維克的路程。'
            }, {
                time: '10:30-12:00',
                activity: '博爾加內斯 (Borgarnes)',
                drive: 90,
                stay: 90,
                note: '在小鎮休息、用午餐，並欣賞海岸線風光。'
            }, {
                time: '13:30',
                activity: '抵達雷克雅維克',
                drive: 90,
                stay: 0,
                note: '入住 奧丁斯維酒店 (Hotel Odinsve)。'
            }, {
                time: '14:30',
                activity: '雷克雅維克市區自由活動',
                drive: 0,
                stay: 0,
                note: '享受在市區的最後時光，購買紀念品或享受美食。'
            }]
        }, {
            day: '第十一天',
            date: '10月21日 (星期一)',
            theme: '悠閒與返程',
            schedule: [{
                time: '上午',
                activity: '在雷克雅維克自由活動',
                drive: 0,
                stay: 0,
                note: '睡到自然醒，在市區享用悠閒早餐。'
            }, {
                time: '12:00',
                activity: 'Sky Lagoon',
                drive: 15,
                stay: 120,
                note: '在回國前，再次體驗冰島獨特的溫泉，從另一種角度欣賞市區風景。'
            }, {
                time: '15:00',
                activity: '前往凱夫拉維克國際機場 (KEF)',
                drive: 40,
                stay: 0,
                note: '提早前往機場，準備還車。'
            }, {
                time: '15:45',
                activity: 'Blue Car Rental 還車',
                drive: 0,
                stay: 0,
                note: '還車並辦理登機手續。'
            }]
        }, {
            day: '第十二天',
            date: '10月22日 (星期二)',
            theme: '抵達台北',
            schedule: [{
                time: '全天',
                activity: '轉機與返程',
                drive: 0,
                stay: 0,
                note: '抵達桃園國際機場，結束美好旅程。'
            }]
        }];

        // Accommodation data
        const accommodationData = [{
            day: '第一天',
            place: '雷克雅維克市區',
            name: 'Airbnb'
        }, {
            day: '第三天',
            place: '維克',
            name: 'The Barn'
        }, {
            day: '第四天',
            place: '傑古沙龍冰河湖附近',
            name: 'Hali Country Hotel'
        }, {
            day: '第五天',
            place: '霍夫',
            name: 'The Greyhouse'
        }, {
            day: '第六天',
            place: '胡薩維克',
            name: 'Airbnb'
        }, {
            day: '第七天',
            place: '阿克雷里',
            name: 'E18 Apartments'
        }, {
            day: '第八天',
            place: '布扎達呂爾',
            name: '城堡民宿 (Castle Guesthouse)'
        }, {
            day: '第九天',
            place: '阿爾納斯塔皮',
            name: 'Grund'
        }, {
            day: '第十天',
            place: '雷克雅維克',
            name: '奧丁斯維酒店 (Hotel Odinsve)'
        }, {
            day: '第十一天',
            place: '返程',
            name: '無住宿'
        }];

        // To-do list and memo data
        const todoData = [{
            status: 'pending',
            text: '預定藍湖溫泉門票'
        }, {
            status: 'pending',
            text: '預定冰川健行行程'
        }, {
            status: 'pending',
            text: '預定租車'
        }, {
            status: 'pending',
            text: '查詢當地用餐地點'
        }];

        const memoData = [
            '冰島加油站是自助式，需使用信用卡。',
            '多數景點停車需付費，可使用 app 繳費。',
            '冬季日照短，行程時間規劃需更彈性。',
            '冰島天氣多變，建議採洋蔥式穿搭。',
            '極光觀測需天時地利人和，勿抱過高期待。',
            '<a href="https://shiningchan.com/blog/post/iceland-travel-introduction/" class="text-blue-500 hover:underline">環島行程參考</a>',
            '<a href="https://bobbyfun.tw/2024-01-16-2754/" class="text-blue-500 hover:underline">環島行程參考</a>',
            '<a href="https://toyadailylife.com/bring-to-iceland/" class="text-blue-500 hover:underline">必備物品清單</a>'
        ];

        // Global Chart variable
        let timeChart = null;

        // Get DOM elements
        const tabsContainer = document.querySelector('nav');
        const tabContents = document.querySelectorAll('.tab-content');
        const dayNavList = document.getElementById('day-nav-list');
        const currentDayTitle = document.getElementById('current-day-title');
        const currentDayTheme = document.getElementById('current-day-theme');
        const itineraryTableBody = document.getElementById('itinerary-table-body');
        const accommodationTab = document.getElementById('accommodation-tab');
        const todoListContainer = document.getElementById('todo-list');
        const memoListContainer = document.getElementById('memo-list');
        const chartCanvas = document.getElementById('timeChart');

        // Function to handle tab switching
        function setupTabs() {
            tabsContainer.addEventListener('click', (event) => {
                const target = event.target;
                if (target.matches('.tab-btn')) {
                    const tabName = target.dataset.tab;

                    // Deactivate all tabs and content
                    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

                    // Activate selected tab and content
                    target.classList.add('active');
                    document.getElementById(`${tabName}-tab`).classList.add('active');
                    
                    // Specific rendering for each tab
                    if (tabName === 'itinerary') {
                        renderDay(0);
                    } else if (tabName === 'accommodation') {
                        renderAccommodation();
                    } else if (tabName === 'memo') {
                        renderTodoAndMemo();
                    }
                }
            });
        }

        // Function to render the navigation menu
        function renderNav() {
            dayNavList.innerHTML = itineraryData.map((day, index) => `
                <li>
                    <button class="sidebar-nav-btn w-full text-left py-3 px-4 rounded-xl transition-colors duration-200 font-semibold text-gray-700 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-500 active:bg-blue-200" data-day-index="${index}">
                        ${day.day} - ${day.date}
                    </button>
                </li>
            `).join('');

            document.querySelectorAll('.sidebar-nav-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const dayIndex = event.target.dataset.dayIndex;
                    renderDay(dayIndex);
                });
            });
        }

        // Function to render the selected day's itinerary and chart
        function renderDay(dayIndex) {
            // Remove active state from all buttons
            document.querySelectorAll('.sidebar-nav-btn').forEach(btn => btn.classList.remove('active'));

            // Add active state to the current button
            const currentButton = dayNavList.querySelector(`[data-day-index="${dayIndex}"]`);
            if (currentButton) {
                currentButton.classList.add('active');
            }

            const currentDay = itineraryData[dayIndex];
            // Update header
            currentDayTitle.textContent = `${currentDay.day} - ${currentDay.date}`;
            currentDayTheme.textContent = `主題：${currentDay.theme}`;

            // Clear previous table content
            itineraryTableBody.innerHTML = '';

            let totalDriveTime = 0;
            let totalStayTime = 0;

            // Render new table content and calculate totals
            currentDay.schedule.forEach(item => {
                const tr = document.createElement('tr');
                tr.classList.add('hover:bg-gray-50', 'transition-colors');
                tr.innerHTML = `
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">${item.time}</td>
                    <td class="px-4 py-3 whitespace-now-wrap text-sm font-medium text-gray-900">${item.activity}</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">${item.drive ? item.drive + ' 分鐘' : '-'}</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">${item.stay ? item.stay + ' 分鐘' : '-'}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${item.note}</td>
                `;
                itineraryTableBody.appendChild(tr);

                totalDriveTime += item.drive;
                totalStayTime += item.stay;
            });
            
            // Render Chart
            renderTimeChart(totalDriveTime, totalStayTime);
        }
        
        // Function to render the time allocation chart
        function renderTimeChart(drive, stay) {
            // Destroy existing chart instance to prevent errors
            if (timeChart) {
                timeChart.destroy();
            }

            const ctx = chartCanvas.getContext('2d');
            timeChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['開車時間', '活動時間'],
                    datasets: [{
                        label: '時間分配',
                        data: [drive, stay],
                        backgroundColor: [
                            'rgb(59, 130, 246)', // Tailwind blue-500
                            'rgb(249, 115, 22)' // Tailwind orange-500
                        ],
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 14,
                                    family: 'Noto Sans TC'
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + ' 分鐘';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Function to render the accommodation section
        function renderAccommodation() {
            accommodationTab.innerHTML = accommodationData.map(item => `
                <div class="bg-gray-50 p-6 rounded-2xl shadow-lg border border-gray-200">
                    <h3 class="text-xl font-bold text-blue-800 mb-2">${item.day} - ${item.place}</h3>
                    <p class="text-gray-600">住宿：<span class="font-semibold text-gray-900">${item.name}</span></p>
                </div>
            `).join('');
        }

        // Function to render the to-do list and memo
        function renderTodoAndMemo() {
            todoListContainer.innerHTML = todoData.map(item => `
                <li class="flex items-center">
                    <span class="mr-3 text-lg">${item.status === 'done' ? '✅' : '⏳'}</span>
                    <span class="${item.status === 'done' ? 'line-through text-slate-400' : ''}">${item.text}</span>
                </li>
            `).join('');

            memoListContainer.innerHTML = memoData.map(item => `
                <li class="flex items-start">
                    <span class="mr-3 text-sky-500 mt-1">♦️</span>
                    <span>${item}</span>
                </li>
            `).join('');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            setupTabs();
            renderNav();
            // Render the first day by default
            renderDay(0);
        });
    </script>
</body>

</html>

